<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
	<script type="importmap">
	{
		"imports": {
			"three": "https://cdn.jsdelivr.net/npm/three@0.174.0/build/three.module.js",
			"three/examples/jsm/controls/OrbitControls.js": "https://cdn.jsdelivr.net/npm/three@0.174.0/examples/jsm/controls/OrbitControls.js",
			"lil-gui": "https://cdn.jsdelivr.net/npm/lil-gui@0.18.1/dist/lil-gui.esm.min.js"
		}
	}
	</script>

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Organism Simulation</title>
    <style>
        body { margin: 0; overflow: hidden; font-family: Arial, sans-serif; }
        #ui-container { position: absolute; left: 10px; top: 10px; }
        #kill-counter {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.7);
            color: #00ffcc;
            padding: 10px 20px;
            border-radius: 5px;
            font-size: 18px;
            font-weight: bold;
            z-index: 1000;
            text-shadow: 0 0 5px rgba(0, 255, 204, 0.5);
        }
    </style>
</head>
<body>


    <div id="ui-container"></div>
	<div id="kill-counter">Cancer Cells Killed: 0</div>
	<div id="instructions-hint" style="position: absolute; top: 50%; left: 10px; transform: translateY(-50%);
		 color: white; font-size: 16px; background: rgba(0,0,0,0.5); padding: 5px 10px; border-radius: 5px; z-index: 10;">
		Press H for instructions
	</div>

	<div id="instructions-overlay" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%;
		 background: rgba(0, 0, 0, 0.75); color: white; display: none; z-index: 1000; font-size: 18px; padding: 40px;">
		<h2>Simulation Instructions</h2>
		<ul>
			<li><b>Add White Blood Cell</b>: Chases and eats pathogens</li>
			<li><b>Add Pathogen</b>: Roams randomly and emits signals</li>
			<li><b>Add Cancer Cell</b>: Stays clustered and emits cancer signals</li>
			<li><b>Add Cytotoxic T Cell</b>: Hunts and eliminates cancer cells</li>
			<li>Adjust diffusion/decay to simulate immune signaling behavior</li>
		</ul>
		<p><i>Press H again to hide this overlay</i></p>
	</div>

    <!-- Main JavaScript -->
    <script type="module" src="index.js"></script>

    <!-- Live Server Auto-Reload Script -->
    <script type="text/javascript">
        if ('WebSocket' in window) {
            (function() {
                function refreshCSS() {
                    var sheets = [].slice.call(document.getElementsByTagName("link"));
                    var head = document.getElementsByTagName("head")[0];
                    for (var i = 0; i < sheets.length; ++i) {
                        var elem = sheets[i];
                        head.removeChild(elem);
                        var rel = elem.rel;
                        if (elem.href && typeof rel != "string" || rel.length == 0 || rel.toLowerCase() == "stylesheet") {
                            var url = elem.href.replace(/(&|\?)_cacheOverride=\d+/, '');
                            elem.href = url + (url.indexOf('?') >= 0 ? '&' : '?') + '_cacheOverride=' + (new Date().valueOf());
                        }
                        head.appendChild(elem);
                    }
                }
                var protocol = window.location.protocol === 'http:' ? 'ws://' : 'wss://';
                var address = protocol + window.location.host + window.location.pathname + '/ws';
                var socket = new WebSocket(address);
                socket.onmessage = function(msg) {
                    if (msg.data == 'reload') window.location.reload();
                    else if (msg.data == 'refreshcss') refreshCSS();
                };
                console.log('Live reload enabled.');
            })();
        }
    </script>
	<script>
    document.addEventListener('keydown', (e) => {
        if (e.key.toLowerCase() === 'h') {
            const overlay = document.getElementById('instructions-overlay');
            overlay.style.display = (overlay.style.display === 'none') ? 'block' : 'none';
        }
    });

    // Initialize global kill counter
    window.cancerCellsKilled = 0;
</script>

	
</body>
</html>
